---
layout: post
title: 折返
tags: ['連鎖', '手順', '副砲', '連鎖尾']
---

折返，也有人叫作轉彎，日文為折り返し，英文稱作transition。他與連鎖尾都是作中型以上連鎖時必備的技巧。

## 折返是甚麼？

讓我們以標準的[3-1階梯]({% link _wiki/B_chain/b_regular_form/i_stairs.md %})為例說明折返的概念。一個五連鎖的3-1階梯如下：

{% figure %}
{% puyosim mode: 0 %}
                 
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||   B Y R G   ||
||   G B Y R G ||
||   G B Y R G ||
||   G B Y R G ||
++=============++
{% endpuyosim %}
{% endfigure %}

這連鎖的發火是第一行的綠色，方向為從左至右。然而，左側已經無法再用3-1的概念往前加連鎖了！因為若是再擺其他顏色在第一行，就會堵住發火點，無法連鎖了。

{% figure %}
{% puyosim mode: 0 %}
                 
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
|| G B Y R G   ||
|| R G B Y R G ||
|| R G B Y R G ||
|| R G B Y R G ||
++=============++
{% endpuyosim %}
{% endfigure %}

因此，若要繼續加連鎖，此時只能放棄從左到右進行連鎖的想法，改成往上加連鎖！一個可能的發展如下：

{% figure %}
{% puyosim mode: 0 %}
                 
||             ||
||             ||
||             ||
||             ||
|| G           ||
|| R           ||
|| G           ||
|| G           ||
|| G B Y R G   ||
|| R G B Y R G ||
|| R G B Y R G ||
|| R G B Y R G ||
++=============++
{% endpuyosim %}
{% endfigure %}


至此右側又有空間能加連鎖了，可能的發展如下：

{% figure %}
{% puyosim mode: 0 %}
                 
||             ||
||             ||
||             ||
||       Y     ||
|| G       B   ||
|| R G R   Y   ||
|| G R B B Y   ||
|| G R R B Y   ||
|| G B Y R G   ||
|| R G B Y R G ||
|| R G B Y R G ||
|| R G B Y R G ||
++=============++
{% endpuyosim %}
{% caption %}
延伸完畢後，可以從D行黃色發火。
{% endfigure %}

我們能發現到，連鎖已經分成兩層，下層的順序是由左至右，而上層的連鎖順序是從右至左的，與下層相反。我們就把下層稱作*一樓（或地基、日文為土台）*，上層稱作*二樓*，而左側的縱向連鎖是一、二樓的交界處，也是兩樓連鎖反向之處，因此稱作*折返*。

![圖5](https://i.imgur.com/Gbujhc7.png)

## 折返：初級到中級的門檻

**折返看似簡單，但若是讀者實際排排看，可能會發現他不太容易**！理由是，折返位在場地的最左側／最右側，由於其中一邊是面對牆壁，只剩三邊能與其他氣泡連結。
位在這些地方的氣泡，他們能被消除的方式比較有限，或者換句話說，遇到不要的氣泡時，這些氣泡能被棄置的方式也很有限。

{% figure %}
{% puyosim mode:0 %}
                 
||             ||
||             ||
||             ||
||       -     ||
||     - G -   ||
|| -     -     ||
|| R -         ||
|| -           ||
||             ||
||             ||
||             ||
||             ||
++=============++
{% endpuyosim %}
{% endfigure %}

同樣的討論也告訴我們，**既然折返比較難排，表示他應有較高的優先順位**。如果氣泡來得好，應該先考慮拿去排折返，因此也不一定要將地基全部排完再建構折返。以下用些實際例子來示範如何折返。

### 折返例1（鑰匙）

假設已排好[鑰匙]({% link _wiki/B_chain/b_regular_form/ii_sandwich.md %})的地基，接下來三手分別為藍綠、綠綠、黃黃，

{% figure %}
{% puyosim mode:0 %}
                 
||             ||
||   B   G   Y ||
||   G   G   Y ||
||             ||
||             ||
||             ||
||     B       ||
|| Y   G       ||
|| R R B G     ||
|| R B G G B   ||
|| Y R B Y Y B ||
|| Y R B G Y B ||
++=============++
{% endpuyosim %}
{% endfigure %}

由於現在手與下手分別有三顆綠色，不妨將綠色拿來作折返的縱向部分，

{% figure %}
{% puyosim mode:0 %}
                 
||             ||
||   Y         ||
||   Y         ||
||             ||
||             ||
||             ||
||     B       ||
|| Y   G     G ||
|| R R B G B G ||
|| R B G G B G ||
|| Y R B Y Y B ||
|| Y R B G Y B ||
++=============++
{% endpuyosim %}
{% caption %}
折返製作過程：將藍綠放在EF行，下一手綠綠放在F行。
{% endfigure %}

至此，折返最難的縱向部分幾乎已完成，連鎖順序大致是綠→藍→黃→……，只差補上相應顏色的氣泡。因此這手黃黃不一定要拿來補折返（例如可拿去補A行的黃色連鎖），不過此例中，假設我們就將他排在DE行。下圖為此後可能的發展例。

{% figure %}
{% puyosim mode:0 %}
                 
||             ||
||             ||
||             ||
||       Y     ||
||             ||
||           Y ||
||     B Y G B ||
|| Y   G Y Y G ||
|| R R B G B G ||
|| R B G G B G ||
|| Y R B Y Y B ||
|| Y R B G Y B ||
++=============++
{% endpuyosim %}
{% puyosim mode:0 %}
                 
||             ||
||             ||
||             ||
||       R     ||
||           B ||
||           G ||
||     B R R R ||
|| Y   G Y Y G ||
|| R R B G B G ||
|| R B G G B G ||
|| Y R B Y Y B ||
|| Y R B G Y B ||
++=============++
{% endpuyosim %}
{% caption %}
排完折返後可能的兩個發展例。左圖為黃色發火，右圖為紅色發火。
{% endfigure %}

### 折返例2（階梯）

假設已經排好[3-1階梯]({% link _wiki/B_chain/b_regular_form/i_stairs.md %})地基的四連鎖，接下來三手分別為黃紅、黃紅、紅綠，

{% figure %}
{% puyosim mode:0 %}
                 
||             ||
||   Y   Y   R ||
||   R   R   G ||
||             ||
||             ||
||             ||
||             ||
||             ||
||   B G R     ||
||   Y B G R   ||
||   Y B G R   ||
||   Y B G R B ||
++=============++
{% endpuyosim %}
{% endfigure %}

由於紅色很多，不妨拿紅色來作折返，

{% figure %}
{% puyosim mode:0 %}
                 
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||   Y         ||
||   Y         ||
|| G B G R     ||
|| R Y B G R   ||
|| R Y B G R   ||
|| R Y B G R B ||
++=============++
{% endpuyosim %}
{% caption %}
折返製作過程：將兩手紅黃放在AB行，第三手紅綠以紅下綠上擺在A行。
{% endfigure %}

至此，A行與B行仍有高低差，因此折返還未完成，需要再將綠色排高。將來的連鎖順序大致是黃→綠→紅→……，可能的發展如下：

{% figure %}
{% puyosim mode:0 %}
                 
||             ||
||             ||
||   G         ||
||   G B       ||
|| Y Y         ||
|| R B         ||
|| Y Y B       ||
|| G Y B       ||
|| G B G R     ||
|| R Y B G R   ||
|| R Y B G R   ||
|| R Y B G R B ||
++=============++
{% endpuyosim %}
{% puyosim mode:0 %}
                 
||             ||
||             ||
|| Y           ||
|| R Y         ||
|| G           ||
|| Y           ||
|| G Y         ||
|| G Y         ||
|| G B G R     ||
|| R Y B G R   ||
|| R Y B G R   ||
|| R Y B G R B ||
++=============++
{% endpuyosim %}
{% caption %}
排完折返後可能的兩個發展例。左圖為藍色發火，右圖為黃色發火。
{% endfigure %}

以上的兩個例子指出一些做折返的策略，**如果看next氣泡發現某個顏色來得特別多，通常可以考慮將其作為折返的縱向連鎖**。

### 折返例3（GTR）

[GTR]({% link _wiki/B_chain/c_irregular_form/i_gtr.md %})是一種特別的折返排法，在定義上，他只包含折返的L字與折返後的一連鎖，

{% figure %}
{% puyosim mode:0 %}
                 
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
|| G R         ||
|| G G R       ||
|| R R -       ||
++=============++
{% endpuyosim %}
{% endfigure %}

GTR的優點是，從一樓排完如上的L字之後，就已經到二樓了，A行跟B行間已經沒有額外的段差需要彌補！跟GTR比起來，定型的3-1跟鑰匙都需要去彌補額外的段差才能到二樓：3-1需要四格段差，鑰匙則需要兩格段差。

{% figure %}
{% puyosim mode:0 %}
                 
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||   B Y R G - ||
|| B Y R G B - ||
|| B Y R G B - ||
|| B Y R G B - ||
++=============++
{% endpuyosim %}
{% puyosim mode:0 %}
                 
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||             ||
||           G ||
|| - G R Y B G ||
|| - B R R B B ||
|| B G G Y Y G ||
|| B G R Y B G ||
++=============++
{% endpuyosim %}
{% caption %}
左圖的3-1原本用F行的藍色發火，若要繼續往前加連鎖，必須先在F行補上四顆氣泡弭平跟E行的段差才能抵達二樓。右樓的鑰匙原本用A行的藍色發火，需要補上兩顆氣泡才能抵達二樓。
{% endfigure %}

### 折返例4（3-1折返的禁忌）

通常要做3-1折返時，都會用三顆縱向的同色氣泡埋住發火點，再排到二樓。然而，此時有個非常有名的顏色限制需要格外注意：**以折返在右邊的3-1為例，F行跟D行不能同色**。

下圖描述了這個現象：左圖已經做完折返抵達二樓，用E行的藍色可以順利發火八連鎖。另一方面，若是F行下面的黃色跟D行（綠色）同色，如右圖，那麼便會同消，主線只有四連鎖。讀者可按下圖模擬器的播放按鍵，看看連鎖發火後發生了甚麼事。

{% figure %}
{% puyosim mode:0 %}
                 
||             ||
||             ||
||           B ||
||         B Y ||
||           R ||
||           B ||
||         B R ||
||         B R ||
||   B Y R G R ||
|| B Y R G B Y ||
|| B Y R G B Y ||
|| B Y R G B Y ||
++=============++
{% endpuyosim %}
{% puyosim mode:0 %}
                 
||             ||
||             ||
||           B ||
||         B G ||
||           R ||
||           B ||
||         B R ||
||         B R ||
||   B Y R G R ||
|| B Y R G B G ||
|| B Y R G B G ||
|| B Y R G B G ||
++=============++
{% endpuyosim %}
{% caption %}
左圖：一個順利的3-1八連鎖；右圖：將F行的黃色改成綠色後，有顏色衝突，只有四連鎖。
{% endfigure %}

## 折返相關的名詞

最後，我們介紹兩個折返相關的名詞。

**左折／右折：**意指折返的位置，例如左折指的便是折返在左邊，因此一樓連鎖方向為從左至右，二樓連鎖方向為從右至左。例如，折返例3的GTR便是左折。

**先折／後折：**意指折返在整個主線的相對時間，先折指的是先將重點放在折返的建構，後折則是指先將重點放在地基上。

{%- comment -%}
related:
受けの広さ
TODO:
3-1折返的顏色衝突、墊子、多重折、連鎖尾用在折返、折返作為副砲
{%- endcomment -%}
