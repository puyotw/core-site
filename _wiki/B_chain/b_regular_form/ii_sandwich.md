---
layout: post
title: 鑰匙
tags: ['連鎖', '定型', '插入式']
---

鑰匙排法，中文又稱為三明治或是key，SEGA官方的中文翻譯為「夾疊」[^1]。鑰匙的日文為鍵積み（かぎつみ），英文稱作sandwich。他是利用插入式連鎖的一種固定形狀的連鎖排法，與[階梯]({{ "wiki/B_chain/b_regular_form/i_stairs" | relative_url }})兩者被合稱為「定型」，代表相對於「不定型」而言，他們的形狀容易理解，適合初學者作為入門的排法。

{% figure %}
  [![標準鑰匙1](https://i.imgur.com/mdv10Al.png)](https://puyonexus.com/chainsim/chain/Ztuv6)
  [![標準鑰匙2](https://i.imgur.com/EZrXBid.png)](https://puyonexus.com/chainsim/chain/ibFse)
{% caption %}
鑰匙的兩種標準排法。左圖又稱為「2-1-1」，代表從底部往上同色氣泡相連的顆數，而右圖就稱為「1-1-2」。
{% endfigure %}

同樣的，實際練習時不總是能排成上面的標準形狀，因此適當做些「妥協形狀」也是很重要的。以下，我們討論鑰匙的妥協形狀跟練習要點。

## 鑰匙排法的妥協

### L字變形

L字，指的是同色氣泡以「L」的形狀三顆相連的狀態。排鑰匙時，L字是個常用的變形，下面是些L字的鑰匙例子：


{% figure %}
  [![L字1](https://i.imgur.com/keNBFqE.png)](https://puyonexus.com/chainsim/chain/FtQJ2)
  [![L字2](https://i.imgur.com/SyUBkF5.png)](https://puyonexus.com/chainsim/chain/XFACR)
{% caption %}
運用L字的鑰匙變形。L字可以在較低的位置，如左圖第二連鎖的綠色，也可以在較高的位置，如左圖第五連鎖的藍色。另外，為了分別這兩種L字，也有人說較低的L字是3-0-1，而較高的L字是1-0-3。
{% endfigure %}

### 尾端妥協型

這邊介紹一種鑰匙的尾端妥協型，他沒有確切的名字，然而在排鑰匙時卻非常有用。下面左圖是標準的鑰匙，右邊是尾端妥協型，他在最後兩連鎖做了點變化，把倒數第二連鎖的綠色改成段差式。
 
{% figure %}
  [![尾端妥協1](https://i.imgur.com/5Q5BIHj.png)](https://puyonexus.com/chainsim/chain/M2Jqv)
  [![尾端妥協2](https://i.imgur.com/Yb8Rard.png)](https://puyonexus.com/chainsim/chain/4o3VQ)
{% caption %}
標準型與尾端妥協型。兩種所占的面積、外圍形狀完全一樣，因此使用妥協型也不會影響到二樓的建構。
{% endfigure %}

尾端妥協型的應用情境如下。假設在下圖左中，接下來的氣泡是黃紅，那麼已經無法排成標準型或L字，但是可往妥協型發展，如下圖右。

{% figure %}
  [![尾端妥協3](https://i.imgur.com/XaxcBeQ.png)](https://puyonexus.com/chainsim/chain/PAjHL)
  [![尾端妥協4](https://i.imgur.com/GaTWA5Z.png)](https://puyonexus.com/chainsim/chain/PN6kD)
{% caption %}
標準型與尾端妥協型。兩種所占的面積、外圍形狀完全一樣，因此使用妥協型也不會影響到二樓的建構。
{% endfigure %}

## 鑰匙排法練習要點

鑰匙排法的練習要點，其精神與3-1有些類似之處，讀者練習時可先參考[階梯]({{ "wiki/B_chain/b_standard_patterns/i_stairs" | relative_url }})頁面的3-1階梯練習要點。此處就著眼在鑰匙較有特色的地方，也就是L字變形。

### 1. L字變形應用例1

例如，假設已經排好下圖的形狀，
 
{% figure %}
  [![L字應用1](https://i.imgur.com/23FdWxy.png)](https://puyonexus.com/chainsim/chain/aFCfg)
{% endfigure %}

而且接下來的氣泡是紅紅。如果要求只能標準的鑰匙（2-1-1或1-1-2），這手紅紅必然是不能跟場上的紅色相連的，他只能另開新的一行。然而這也代表新的那行還會缺兩顆紅色，而場上的這顆紅色還缺三顆，因此共缺五顆紅色，這稍微限制了未來的發展。除非事前已從next看到夠多的紅色，否則這樣擺稍微不妥。

另一方面，考慮使用L字變形的話，則能將紅紅擺在DE行，成為一個向右的L字：

{% figure %}
  [![L字應用2](https://i.imgur.com/ybBE0u4.png)](https://puyonexus.com/chainsim/chain/YmMaK)
{% endfigure %}

下面是理想的延伸例子。

{% figure %}
  [![L字應用3](https://i.imgur.com/1OZ1RsI.png)](https://puyonexus.com/chainsim/chain/eCDDF)
{% caption %}
運用L字變形後的延伸例。
{% endfigure %}

一個要注意的點是，在這個例子中，原本的地形還未決定連鎖方向，然而用了L字之後，由於這個L字是向右的，整個連鎖也跟著要是從左至右了。

### 2. L字妥協應用例2

例如，假設前兩手是黃藍、黃綠，已經將黃色擺在中間湊成兩顆，

{% figure %}
  [![L字應用4](https://i.imgur.com/PAQMYCr.png)](https://puyonexus.com/chainsim/chain/7VSps)
{% endfigure %}

並假設第三手為黃紅。由於場上的黃色兩側都不是紅色，因此若不使用L字，那這手只能直接新開兩行，將紅黃擺在EF，

{% figure %}
  [![L字應用5](https://i.imgur.com/cDP7Qjc.png)](https://puyonexus.com/chainsim/chain/VGphb)
{% endfigure %}

然而，這種作法限制了E行與F行的顏色，讓他們必須是紅色跟黃色。考慮使用L字變形的話，則能這手黃紅做出一個黃色L字，

{% figure %}
  [![L字應用6](https://i.imgur.com/AdgAn9f.png)](https://puyonexus.com/chainsim/chain/jc5DG)
  [![L字應用7](https://i.imgur.com/MQ2kEN1.png)](https://puyonexus.com/chainsim/chain/dz7ij)
{% endfigure %}

用這種做法，等於只開了一個新行（紅色），並且還補上了舊行的黃色，因此對未來發展的限制較小。

上面這兩種L字作法，一個是方向往左、蓋住藍色，另一個是方向往右、蓋住綠色。要使用哪種L字，可由接下來的氣泡決定。例如，如果下一手是紅綠，那向右的L字是個好選擇。

{% figure %}
  [![L字應用8](https://i.imgur.com/ERwXvRU.png)](https://puyonexus.com/chainsim/chain/sChTb)
  [![L字應用9](https://i.imgur.com/WxR8Doo.png)](https://puyonexus.com/chainsim/chain/UNc5P)
{% caption %}
做出黃色L字後，如果下手是紅綠，可將紅綠擺在E行，如圖左。右圖是個發展例。
{% endfigure %}

### 3. L字變形的顏色限制

雖然活用L字能讓鑰匙的主線進行得更順利，使用L字會讓隔幾行的氣泡產生顏色限制，必須格外注意。

下面兩張圖是個例子。左圖中，綠色使用了1-0-3的L字，右邊有四顆顏色待定的氣泡，先用黑色呈現。需要注意的是，由於這四顆氣泡與紅色相連，黑色絕對不能是紅色！這便是L字造成的顏色限制：**L字左側跟L字右側的顏色不能一樣**。

右圖也是同樣道理，綠色是個的3-0-1的L字，黑色的待定氣泡們也不能是紅色。
 
{% figure %}
  [![L字顏色限制1](https://i.imgur.com/EXHK2Hh.png)](https://puyonexus.com/chainsim/chain/af4xP)
  [![L字顏色限制2](https://i.imgur.com/wLzjx9u.png)](https://puyonexus.com/chainsim/chain/VQvq3)
{% caption %}
做出黃色L字後，如果下手是紅綠，可將紅綠擺在E行，如圖左。右圖是個發展例。
{% endfigure %}

## 參考資料

鑰匙排法中文教學影片：[魔法氣泡小學堂 by RM9](https://www.youtube.com/watch?v=tLOhr0HjnuM)、[魔法氣泡（PuyoPuyo）中高階教學　by acliv](https://www.youtube.com/watch?v=jTBsO61oDKE)

日文網頁攻略教學：[ぷよぷよ講座  カギ積み](http://alg-d.com/game/puyo/chain2.html)、[カギ積み(鍵積み)の積み方とコツ！](https://jiyu-cho.com/puyopuyo-kagi)、[れんのぷよぷよ連鎖教室 鍵積み](http://ren-channnel.com/kaidan/)等等

英文網頁攻略教學：[Puyo Nexus Patterns 2: Sandwich](https://puyonexus.com/wiki/Patterns_2:_Sandwich)

飛車ちゅう的影片：日本的「飛車ちゅう」職業選手專用定型作戰，他排連鎖時亦不是完美標準的定型，而是依據戰況與當下氣泡做適當的變化，讀者可用飛車ちゅう當關鍵字搜尋影片觀摩。

[^1]: [魔法氣泡課程](https://manual.sega.jp/puyopuyo_esports/ct/?pid=27).
